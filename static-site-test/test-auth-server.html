<!-- STEP 3 aggiornato -->
<h4>Step 3: Get the calendar events using your access token</h4>
<button id="getEvents">Get Events</button>
<pre id="events"></pre>

<script type="text/javascript">
  const getEventsButton = document.getElementById("getEvents");
  const eventsElement = document.getElementById("events");

  const getCalendarEventsEndpoint =
    "https://nafbo9hqr8.execute-api.eu-central-1.amazonaws.com/dev/api/get-events";

  getEventsButton.onclick = function () {
    if (!accessTokenElement.innerText) {
      eventsElement.innerText = "Please get an access token first!";
      return;
    }

    const { access_token } = JSON.parse(accessTokenElement.innerText);
    const eventRequest = `${getCalendarEventsEndpoint}/${access_token}`;

    fetch(eventRequest)
      .then((response) => response.json())
      .then((json) => {
        eventsElement.innerText = JSON.stringify(json, null, 2);
      })
      .catch((err) => {
        eventsElement.innerText = `Error fetching events: ${err}`;
      });
  };
</script>
